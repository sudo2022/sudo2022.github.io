# 一、概述
* Adobe ColdFusion:是一个商用的快速应用程序开发平台，可以把他理解成一个可集成网站开发的一个应用平台，使用的文件的扩展名是.cfm。

# 二、影响版本
* Adobe ColdFusion 8、9版本

# 三、漏洞环境搭建
* 这里我使用的是线下环境搭建`vulhub`
```
root@wq:/home/wq/vulhub-master/coldfusion/CVE-2010-2861# ls
1.png  2.png  docker-compose.yml  README.md  README.zh-cn.md
root@wq:/home/wq/vulhub-master/coldfusion/CVE-2010-2861# pwd
/home/wq/vulhub-master/coldfusion/CVE-2010-2861
root@wq:/home/wq/vulhub-master/coldfusion/CVE-2010-2861# docker-compose up -d
root@wq:/home/wq/vulhub-master/coldfusion/CVE-2010-2861# docker ps
CONTAINER ID   IMAGE                     COMMAND                  CREATED         STATUS         PORTS                                       NAMES
1dfb5fb411e2   vulhub/coldfusion:8.0.1   "bash -c '/opt/coldf…"   5 seconds ago   Up 3 seconds   0.0.0.0:8500->8500/tcp, :::8500->8500/tcp   cve-2010-2861_coldfusion_1
root@wq:/home/wq/vulhub-master/coldfusion/CVE-2010-2861# 
```
![图 1](.images/CVE-2010-2861/IMG_20220118-120128790.png)  
![图 2](.images/CVE-2010-2861/IMG_20220118-120206669.png)  
![图 3](.images/CVE-2010-2861/IMG_20220118-120233211.png)  
![图 4](.images/CVE-2010-2861/IMG_20220118-120317354.png)  

* 漏洞环境测试，正常访问：`http://192.168.10.134:8500/CFIDE/administrator/`可以发现登录界面
![图 6](.images/CVE-2010-2861/IMG_20220118-130837686.png)  

# 四、漏洞发现过程
* 拿到一个url分析他的地址后，我们需要去获得一些信息，这里我们看到了登录界面，并且这个版本是`adobe ColdFusion8`的版本,我们开始尝试端口扫描确实也获得了服务的版本信息为`JRun Web Server`
![图 5](.images/CVE-2010-2861/IMG_20220118-120918769.png)  
* 现在我们已经确认是了`adobe ColdFusion`web服务，并且知道了他的版本信息为`8`
* 关于`adobe ColdFusion8` 这种web服务，我们可以尝试使用跨路径访问，去获取他服务的一些目录信息
* 这里我们去构建Payload`http://192.168.10.134:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en`，看到结果我们发现确实看到了一些敏感目录文件
![图 7](.images/CVE-2010-2861/IMG_20220118-131444515.png)  


# 五、总结
* 如何快速发现这是一个`ColdFusion`，我个人的理解，主要看服务的指纹，当然也不一定全对，如果我们在做端口扫描的时候发现他的服务指纹是一个`JRun Web Server` 我们就可以大胆去猜测这是不是一个`ColdFusion`服务，那么如果是这这种服务，它有可能会存在什么样的一个漏洞。上面我们已经测试出了`ColdFusion8`可能会存在跨路径访问系统文件目录的问题，实际上，还有可能会出现，反序列化的漏洞。在遇到这种情况的时候，需要尝试进行分析。

# 六、附录
* 我简单写了一个跨路径访问的脚本，可以进行参考
